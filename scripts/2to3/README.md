# PyWinRT v2 to v3 migration guide

There were some breaking changes in PyWinRT v3. This describes what
you will need to do to upgrade your own code that consumes any packages
generated by PyWinRT.

## Renamed method and attributes

PyWinRT was changed to use the `OverloadAttribute` for method names. This allows
access to methods that were previously hidden due to overloads with the same
number of arguments, but comes at the cost of renaming about 10% of methods.

Additionally, more fixups were added to make acronyms more readable.

The `.csv` files in this directory contain the mapping between the old and new
names for all changed methods/attributes.

There is also a `inspect.py` script that can be used to inspect your Python
files for potential uses of methods and attributes that have been renamed.

### Usage

Pass the source file as an argument to the script. For example:

    py .\scripts\2to3\inspect.py ..\bleak\bleak\backends\winrt\scanner.py

The script will print out the potential matches and suggest the new names:

    ..\bleak\bleak\backends\winrt\scanner.py:201:17
    possible match: winrt.windows.devices.bluetooth.advertisement.BluetoothLEAdvertisementReceivedEventArgs.raw_signal_strength_in_d_bm
    rename to: raw_signal_strength_in_dbm

The first line is `<file name>:<line number>:<column number>`. The second line
gives the fully qualified name of the method or attribute that was found in the
source file. The third line gives the new name that should be used.

Some editors, like VS Code, will automatically turn the first line into a link
that can jump to the location in the source file.

### Caveats

* The script does not search in comments or docstrings.
* The script doesn't do any static analysis to infer types, so it may produce
  false positives.
* Some methods may have overloads with the same number of arguments that are
  now exposed in the projection that previously weren't. In this case, check
  the type hints to ensure the correct overload is being used based on the
  argument types.

## "Casting" WinRT object/interface types

In v2.x to convert an object to another type, it was written as:

```python
new_type = NewType._from(object)
```
In v3.x, the recommended way to write this is:

```python
new_type = object.as_(NewType)
```

`_from()` will still work at runtime, but it has been removed from the
type hints, so linters may flag it as a missing attribute.

## Interop module cleanup

The only breaking change is that `winrt.windows.foundation.interop` was removed.
If you were using the `box()` and `unbox()` methods from this module, they are
replaced by <https://pywinrt.readthedocs.io/en/latest/api/system.html#boxing>.

Additionally, some methods that were previous undocumented and only available
from the `_winrt` module are now documented and can be imported from a
"non-private" module. The old imports will continue to work for now but it is
recommended to switch to the documented imports in
<https://pywinrt.readthedocs.io/en/latest/api/runtime.html> and
<https://pywinrt.readthedocs.io/en/latest/api/runtime.interop.html> in case the
implementation details change in a future release.
